<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{COURSE_TITLE}} - My Education Website</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Add this to your styles.css or here for hiding description */
    .video-description.hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <header>
    <h1>{{COURSE_TITLE}}</h1>
    <nav>
      <a href="index.html" class="back-link">‚Üê Back to Courses</a>
    </nav>
  </header>

  <main class="container">
    <div id="progress-container" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
      <div id="progress-bar"></div>
      <span id="progress-text">0% Completed</span>
    </div>

    <!-- Video Item Template Start -->
    <div class="video-item">
      <label class="custom-checkbox" for="video-1">
        <input type="checkbox" id="video-1" />
        <span class="video-title">Video Title 1</span>
      </label>
      <iframe
        src="https://www.youtube.com/embed/VIDEO_ID_1"
        allowfullscreen
      ></iframe>
      <p class="video-description">
        Description for Video Title 1 goes here.
      </p>
    </div>
    <!-- Video Item Template End -->

    <!-- Duplicate above block for more videos; update IDs, titles, descriptions and YouTube video IDs accordingly -->
  </main>

  <script>
    (function () {
      const STORAGE_KEY = '{{STORAGE_KEY}}';

      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');
      const progressContainer = document.getElementById('progress-container');

      function loadProgress() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const checkedIds = JSON.parse(saved);
          checkboxes.forEach(cb => {
            if (checkedIds.includes(cb.id)) {
              cb.checked = true;
              const videoItem = cb.closest('.video-item');
              const iframe = videoItem.querySelector('iframe');
              const description = videoItem.querySelector('.video-description');
              if (iframe) iframe.classList.add('hidden');
              if (description) description.classList.add('hidden');
            }
          });
        }
      }

      function saveProgress() {
        const checkedIds = Array.from(checkboxes)
          .filter(cb => cb.checked)
          .map(cb => cb.id);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(checkedIds));
      }

      function updateProgress() {
        const total = checkboxes.length;
        const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
        const percent = total === 0 ? 0 : Math.round((checkedCount / total) * 100);
        progressBar.style.width = percent + '%';
        progressText.textContent = percent + '% Completed';
        progressContainer.setAttribute('aria-valuenow', percent);
      }

      function init() {
        loadProgress();
        updateProgress();
        checkboxes.forEach(cb => {
          cb.addEventListener('change', () => {
            const videoItem = cb.closest('.video-item');
            const iframe = videoItem.querySelector('iframe');
            const description = videoItem.querySelector('.video-description');

            if (cb.checked) {
              if (iframe) iframe.classList.add('hidden');
              if (description) description.classList.add('hidden');
            } else {
              if (iframe) iframe.classList.remove('hidden');
              if (description) description.classList.remove('hidden');
            }
            saveProgress();
            updateProgress();
          });
        });
      }

      init();
    })();
  </script>
</body>
</html>
